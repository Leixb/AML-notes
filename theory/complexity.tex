%! TEX root = ../000-main.tex
\section{Model complexity, VC-dimension and generalization bounds}
\index{VC-dimension}\index{complexity}\index{generalization bound}

\begin{definition}{dichotomy of a set}{dichotomy}

  Let $\mathcal{F}$ be a hypothesis set, let $S$ be a set of data points $S =
  \{x_1, \ldots, x_m\},\quad x^i \in \mathds{R}^d$.

  A \iemph{dichotomy} of a set
  $S$ is one of the possible ways of labelling the points in $S$ in
  one of two classes.

\end{definition}

\begin{definition}{Shattering}{shattering}\index{shattering}
  A set $S$ of size $m$ is said to \emph{shatter} by $\mathcal{F}$
  when all $2^m$ possible dichotomies can be realized (makes 0 TR on $S$)
  by a member of
  $\mathcal{F}$.
\end{definition}

\begin{definition}{VC-dimension}{vc-dimension-cont}
  Vapnik-Chervonenkis dimension \\[1em]
  The VC-dimension of a hypothesis space $\mathcal{F}$ is the size
  of the largest set $S$ that can be shattered by $\mathcal{F}$.
\end{definition}

\begin{ex}
  Intervals on the real line ($d = 1$)

  \begin{align*}
    \mathcal{F} = \{[a,\,b]\mid a < b \in \mathds{R}\}
  \end{align*}

\begin{figure}[H]
  \begin{tikzpicture}[
			leftNode/.style={circle,minimum width=.5ex, fill=red,draw},
			rightNode/.style={circle,minimum width=.5ex, red, fill=white,thick,draw},
      limitNodeL/.style={draw,minimum width=0.25ex,minimum height=1ex,fill,label=$a$},
      limitNodeR/.style={draw,minimum width=0.25ex,minimum height=1ex,fill,label=$b$},
    ]

    % \addlegendimage{leftNode};
    % \addlegendentry{+1};
    % \addlegendimage{rightNode};
    % \addlegendentry{-1};

    \draw[->] (-1,0) -- (5,0);
    \draw[->] (-1,1) -- (5,1);
    \draw[->] (-1,2) -- (5,2);

    \node[limitNodeL] at (0,0) {};
    \node[limitNodeR] at (4,0) {};
    \node[leftNode] at (1,0) {};
    \node[leftNode] at (3,0) {};

    \node[limitNodeL] at (0,1) {};
    \node[limitNodeR] at (2,1) {};
    \node[leftNode] at (1,1) {};
    \node[rightNode] at (3,1) {};

    \node[limitNodeL] at (-0.5,2) {};
    \node[limitNodeR] at (0.5,2) {};
    \node[rightNode] at (1,2) {};
    \node[rightNode] at (3,2) {};


	\end{tikzpicture}
\end{figure}
\end{ex}

\begin{figure}[H]
  \begin{tikzpicture}[
			nodeIn/.style={circle,minimum width=.5ex, fill=red,draw},
			nodeOut/.style={circle,minimum width=.5ex, red, fill=white,thick,draw},
      limitNodeL/.style={draw,minimum width=0.25ex,minimum height=1ex,fill,label=$a$},
      limitNodeR/.style={draw,minimum width=0.25ex,minimum height=1ex,fill,label=$b$},
    ]

    % \addlegendimage{leftNode};
    % \addlegendentry{+1};
    % \addlegendimage{rightNode};
    % \addlegendentry{-1};

    \node[nodeIn] at (0, 1) {};
    \node[nodeIn] at (0, -1) {};
    \node[nodeOut] at (1, 0) {};
    \node[nodeOut] at (-1, 0) {};
    \draw (-0.5, -1.5) rectangle (0.5, 1.5);

    \begin{scope}[shift={(4,0)}]
      \node[nodeIn] at (0, 1) {};
      \node[nodeIn] at (0, -1) {};
      \node[nodeOut] at (1, 0) {};
      \node[nodeIn] at (-1, 0) {};
    \draw (-1.5, -1.5) rectangle (0.5, 1.5);
    \end{scope}

    \begin{scope}[shift={(4,4)}]
      \node[nodeIn] at (0, 1) {};
      \node[nodeIn] at (0, -1) {};
      \node[nodeIn] at (1, 0) {};
      \node[nodeIn] at (-1, 0) {};
    \draw (-1.5, -1.5) rectangle (1.5, 1.5);
    \end{scope}

    \begin{scope}[shift={(0,4)}]
      \node[nodeIn] at (0, 1) {};
    \draw (-0.5, 0.5) rectangle (0.5, 1.5);
      \node[nodeOut] at (0, -1) {};
      \node[nodeOut] at (1, 0) {};
      \node[nodeOut] at (-1, 0) {};
    \end{scope}

	\end{tikzpicture}
  \caption{Axis aligned rectangles in $\mathds{R}^2$}
\end{figure}
